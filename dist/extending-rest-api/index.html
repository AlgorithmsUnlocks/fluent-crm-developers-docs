<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Extend the REST API | FluentCRM Developers</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/favicon.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/assets/img/logo.svg" color="#7742e6">
    <link rel="apple-touch-icon" href="/assets/img/logo.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,300;0,500;0,700;1,300;1,500;1,700&amp;display=auto">
    <meta name="description" content="Resources and tutorials for FluentCRM developers">
    <meta name="theme-color" content="#7742e6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/assets/img/icon.svg">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.6c970851.css" as="style"><link rel="preload" href="/assets/js/app.54af8faa.js" as="script"><link rel="preload" href="/assets/js/4.202d7228.js" as="script"><link rel="preload" href="/assets/js/41.b93e1d1c.js" as="script"><link rel="preload" href="/assets/js/6.25d6c35f.js" as="script"><link rel="preload" href="/assets/js/5.36d7588c.js" as="script"><link rel="prefetch" href="/assets/js/1.ccc50939.js"><link rel="prefetch" href="/assets/js/10.a93ee020.js"><link rel="prefetch" href="/assets/js/11.6de29fb5.js"><link rel="prefetch" href="/assets/js/12.8bb2c031.js"><link rel="prefetch" href="/assets/js/13.8b90f23a.js"><link rel="prefetch" href="/assets/js/14.fe783837.js"><link rel="prefetch" href="/assets/js/15.b92236f9.js"><link rel="prefetch" href="/assets/js/16.c05916cc.js"><link rel="prefetch" href="/assets/js/17.d43d02a0.js"><link rel="prefetch" href="/assets/js/18.3533050d.js"><link rel="prefetch" href="/assets/js/19.027ffb1b.js"><link rel="prefetch" href="/assets/js/20.32ea98ef.js"><link rel="prefetch" href="/assets/js/21.78e59a6b.js"><link rel="prefetch" href="/assets/js/22.82643910.js"><link rel="prefetch" href="/assets/js/23.5118c40d.js"><link rel="prefetch" href="/assets/js/24.7d372983.js"><link rel="prefetch" href="/assets/js/25.0bdb77f4.js"><link rel="prefetch" href="/assets/js/26.c32c3ff9.js"><link rel="prefetch" href="/assets/js/27.044ab364.js"><link rel="prefetch" href="/assets/js/28.3b913a8e.js"><link rel="prefetch" href="/assets/js/29.504c4933.js"><link rel="prefetch" href="/assets/js/30.0464ba36.js"><link rel="prefetch" href="/assets/js/31.3231bcf1.js"><link rel="prefetch" href="/assets/js/32.62bf3865.js"><link rel="prefetch" href="/assets/js/33.7c677f9d.js"><link rel="prefetch" href="/assets/js/34.78fc7f36.js"><link rel="prefetch" href="/assets/js/35.abc2a4bb.js"><link rel="prefetch" href="/assets/js/36.b2d45da2.js"><link rel="prefetch" href="/assets/js/37.10e05bfc.js"><link rel="prefetch" href="/assets/js/38.67de45a5.js"><link rel="prefetch" href="/assets/js/39.02647e0c.js"><link rel="prefetch" href="/assets/js/40.f6d5ebcf.js"><link rel="prefetch" href="/assets/js/42.3613ef44.js"><link rel="prefetch" href="/assets/js/43.a3e3a2b2.js"><link rel="prefetch" href="/assets/js/44.6c1d679f.js"><link rel="prefetch" href="/assets/js/45.caa29800.js"><link rel="prefetch" href="/assets/js/46.b05d1d62.js"><link rel="prefetch" href="/assets/js/47.8a57019c.js"><link rel="prefetch" href="/assets/js/48.cf65302a.js"><link rel="prefetch" href="/assets/js/49.bc869897.js"><link rel="prefetch" href="/assets/js/50.74233c86.js"><link rel="prefetch" href="/assets/js/51.4092c465.js"><link rel="prefetch" href="/assets/js/52.e0648eb3.js"><link rel="prefetch" href="/assets/js/53.36094df0.js"><link rel="prefetch" href="/assets/js/54.e1c05629.js"><link rel="prefetch" href="/assets/js/55.bbd54bbb.js"><link rel="prefetch" href="/assets/js/56.1fb2a423.js"><link rel="prefetch" href="/assets/js/57.22199256.js"><link rel="prefetch" href="/assets/js/58.7eb15f0c.js"><link rel="prefetch" href="/assets/js/59.c3612d84.js"><link rel="prefetch" href="/assets/js/60.018202f2.js"><link rel="prefetch" href="/assets/js/61.a92bd38c.js"><link rel="prefetch" href="/assets/js/62.c7d01b92.js"><link rel="prefetch" href="/assets/js/63.e1481903.js"><link rel="prefetch" href="/assets/js/64.b40f70c8.js"><link rel="prefetch" href="/assets/js/65.7ccf9ed5.js"><link rel="prefetch" href="/assets/js/66.9286d4d1.js"><link rel="prefetch" href="/assets/js/67.c20526c6.js"><link rel="prefetch" href="/assets/js/68.fe196dcb.js"><link rel="prefetch" href="/assets/js/69.21684ea4.js"><link rel="prefetch" href="/assets/js/7.28dee799.js"><link rel="prefetch" href="/assets/js/70.15c0a79d.js"><link rel="prefetch" href="/assets/js/71.841dedc1.js"><link rel="prefetch" href="/assets/js/72.3cb42c08.js"><link rel="prefetch" href="/assets/js/73.23e90daf.js"><link rel="prefetch" href="/assets/js/74.0656a71e.js"><link rel="prefetch" href="/assets/js/75.52e77de1.js"><link rel="prefetch" href="/assets/js/76.b14e2b95.js"><link rel="prefetch" href="/assets/js/77.8e45f1ab.js"><link rel="prefetch" href="/assets/js/78.ebb6457f.js"><link rel="prefetch" href="/assets/js/79.24736f95.js"><link rel="prefetch" href="/assets/js/8.a42d882d.js"><link rel="prefetch" href="/assets/js/9.58f3ec84.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.e9e545df.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6c970851.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/icon.svg" alt="FluentCRM Developers" class="logo"> <span class="site-name can-hide">FluentCRM Developers</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/getting-started/" class="nav-link">
  Getting Started
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Database" class="dropdown-title"><span class="title">Database</span> <span class="arrow down"></span></button> <button type="button" aria-label="Database" class="mobile-dropdown-title"><span class="title">Database</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/database/" class="nav-link">
  Database Schema
</a></li><li class="dropdown-item"><!----> <a href="/database/models/" class="nav-link">
  Database Models
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Developer Hooks" class="dropdown-title"><span class="title">Developer Hooks</span> <span class="arrow down"></span></button> <button type="button" aria-label="Developer Hooks" class="mobile-dropdown-title"><span class="title">Developer Hooks</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hooks/actions/" class="nav-link">
  Action Hooks
</a></li><li class="dropdown-item"><!----> <a href="/hooks/filters/" class="nav-link">
  Filter Hooks
</a></li><li class="dropdown-item"><!----> <a href="/global-functions/" class="nav-link">
  Global Functions
</a></li><li class="dropdown-item"><!----> <a href="/helpers/" class="nav-link">
  Helpers Classes
</a></li><li class="dropdown-item"><!----> <a href="/cli/" class="nav-link">
  CLI
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Modules" class="dropdown-title"><span class="title">Modules</span> <span class="arrow down"></span></button> <button type="button" aria-label="Modules" class="mobile-dropdown-title"><span class="title">Modules</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/modules/automation/" class="nav-link">
  Automation
</a></li><li class="dropdown-item"><!----> <a href="/modules/smart-code/" class="nav-link">
  Smart Codes
</a></li><li class="dropdown-item"><!----> <a href="/modules/contact-profile-section/" class="nav-link">
  Contact's Profile
</a></li><li class="dropdown-item"><!----> <a href="/extending-rest-api/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Extending REST API
</a></li></ul></div></div><div class="nav-item"><a href="https://fluentcrm.com/blog/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://rest-api.fluentcrm.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  REST API
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/fluentcrm/fluent-crm-developers-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/getting-started/" class="nav-link">
  Getting Started
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Database" class="dropdown-title"><span class="title">Database</span> <span class="arrow down"></span></button> <button type="button" aria-label="Database" class="mobile-dropdown-title"><span class="title">Database</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/database/" class="nav-link">
  Database Schema
</a></li><li class="dropdown-item"><!----> <a href="/database/models/" class="nav-link">
  Database Models
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Developer Hooks" class="dropdown-title"><span class="title">Developer Hooks</span> <span class="arrow down"></span></button> <button type="button" aria-label="Developer Hooks" class="mobile-dropdown-title"><span class="title">Developer Hooks</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hooks/actions/" class="nav-link">
  Action Hooks
</a></li><li class="dropdown-item"><!----> <a href="/hooks/filters/" class="nav-link">
  Filter Hooks
</a></li><li class="dropdown-item"><!----> <a href="/global-functions/" class="nav-link">
  Global Functions
</a></li><li class="dropdown-item"><!----> <a href="/helpers/" class="nav-link">
  Helpers Classes
</a></li><li class="dropdown-item"><!----> <a href="/cli/" class="nav-link">
  CLI
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Modules" class="dropdown-title"><span class="title">Modules</span> <span class="arrow down"></span></button> <button type="button" aria-label="Modules" class="mobile-dropdown-title"><span class="title">Modules</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/modules/automation/" class="nav-link">
  Automation
</a></li><li class="dropdown-item"><!----> <a href="/modules/smart-code/" class="nav-link">
  Smart Codes
</a></li><li class="dropdown-item"><!----> <a href="/modules/contact-profile-section/" class="nav-link">
  Contact's Profile
</a></li><li class="dropdown-item"><!----> <a href="/extending-rest-api/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Extending REST API
</a></li></ul></div></div><div class="nav-item"><a href="https://fluentcrm.com/blog/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://rest-api.fluentcrm.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  REST API
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/fluentcrm/fluent-crm-developers-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/extending-rest-api/" aria-current="page" class="active sidebar-link">Extend Rest API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/extending-rest-api/#registering-a-custom-endpoint" class="sidebar-link">Registering a Custom Endpoint</a></li><li class="sidebar-sub-header"><a href="/extending-rest-api/#routing" class="sidebar-link">Routing</a></li><li class="sidebar-sub-header"><a href="/extending-rest-api/#controllers" class="sidebar-link">Controllers</a></li><li class="sidebar-sub-header"><a href="/extending-rest-api/#policies" class="sidebar-link">Policies</a></li><li class="sidebar-sub-header"><a href="/extending-rest-api/#directory-structure" class="sidebar-link">Directory Structure</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="extend-the-rest-api"><a href="#extend-the-rest-api" class="header-anchor">#</a> Extend the REST API</h1> <span class="badge tip" style="vertical-align:top;" data-v-15b7b770>Fluent Framework</span> <p>REST (representational state transfer) is a software architectural style that defines a set of constraints to be used for creating Web services.
RESTful Web services allow the requesting systems to access and manipulate Web resources through a standardized interface.
In the context of a WordPress plugin, a REST API allows you to create custom endpoints that can be accessed via HTTP requests. These endpoints can be used to perform various tasks,
such as retrieving data from the WordPress database, creating new posts, updating user information, etc.
For example, you might create a custom REST API endpoint that allows users to retrieve a list of posts from a specific category. To do this, you would create an endpoint URL (e.g. <code>/wp-json/fluent-crm/v2/posts</code>)
and define a callback function that retrieves the posts from the database and returns them in a format
that can be easily consumed by other systems (e.g. JSON).</p> <h2 id="registering-a-custom-endpoint"><a href="#registering-a-custom-endpoint" class="header-anchor">#</a> Registering a Custom Endpoint</h2> <p>FluentCRM uses WordPress REST API. So you can use any authorization method that supports WordPress. You may take a look at built-in
<a href="https://rest-api.fluentcrm.com/" target="_blank" rel="noopener noreferrer">REST API Section<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>FluentCRM enables you to add custom endpoints to its REST API from your plugin, by registering routes,
policies, and controllers in an easy and convenient way.
Let's go through some examples of how you might set up a WordPress plugin to extend the FluentCRM plugin using routers and controllers along with policies.</p> <h2 id="routing"><a href="#routing" class="header-anchor">#</a> Routing</h2> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'fluentcrm_loaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token variable">$app</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token property">router</span><span class="token operator">-&gt;</span><span class="token function">prefix</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'my-prefix'</span> <span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">withPolicy</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'MyPlugin\Policies\MyPolicy'</span> <span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">group</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token variable">$router</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$router</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'MyPlugin\Controllers\MyController@index'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// more routes go here</span>
    <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>The above code registers a route that will be accessible at <code>https://yourdomain.com/wp-json/fluent-crm/2/my-prefix/</code>.</p> <ul><li><strong>API Base URL</strong>: <em><code>https://yourdomain.com/wp-json/fluent-crm/v2/</code></em></li></ul> <p><strong>Note:</strong> <em>Make sure to autoload your classes. Otherwise, you may get an error like this:
<code>Class \MyPlugin\Policies\MyPolicy does not exist</code>. You need to autoload your classes before the <code>fluentcrm_loaded</code> action is fired.</em></p> <p>This code uses the <code>add_action</code> function to register a callback function that will be called when the fluentcrm_loaded action is triggered.
The callback function sets up a route using the FluentCRM router, which is passed to the function as an argument.
The route is defined using the <code>prefix</code> and <code>group</code> methods of the router. The <code>prefix</code> method sets a prefix for the route, which will be added to the beginning of the route's URL.
The <code>withPolicy</code> method sets a policy class that will be used to authorize the request. We will discuss policies in more detail later in this article.
The <code>group</code> method creates a group of routes that share the same prefix and policy.
Inside the group, the <code>get</code> method is used to define a route for a GET request to the URL <code>/my-prefix/</code>.
The route is handled by the <code>index</code> method of the MyController class in the <code>MyPlugin\Controllers</code> namespace.
Note that group and prefix methods are optional. You can also define routes without them.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code> <span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token property">router</span><span class="token operator">-&gt;</span><span class="token function">post</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'/your-url-path/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'MyPlugin\Controllers\MyController@create'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="route-parameters"><a href="#route-parameters" class="header-anchor">#</a> Route Parameters</h3> <p>You can also define route parameters. For example, if you want to define a route that handles a GET request to the URL <code>/show/{id}</code>,
you can do it like this:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code> <span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token property">router</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/show/{id}'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'MyPlugin\Controllers\MyController@show'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">int</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>The <code>int</code> method tells the router that the <code>id</code> parameter should be an integer. You may chain multiple methods to define multiple parameters.
The <code>alpha</code> accepts only alphabetic characters.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code> <span class="token comment">/* in routes */</span>
 <span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token property">router</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/show/{id}/{name}'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'MyPlugin\Controllers\MyController@show'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">int</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">alpha</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">/*
* Route parameters can be directly accessed in the controller method
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">show</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">,</span> <span class="token variable">$name</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// do something</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="available-router-methods"><a href="#available-router-methods" class="header-anchor">#</a> Available Router methods</h3> <p>The router allows you to define routes for the following HTTP verb:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$router</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span> <span class="token variable">$uri</span><span class="token punctuation">,</span> <span class="token variable">$callback</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$router</span><span class="token operator">-&gt;</span><span class="token function">post</span><span class="token punctuation">(</span> <span class="token variable">$uri</span><span class="token punctuation">,</span> <span class="token variable">$callback</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$router</span><span class="token operator">-&gt;</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token variable">$uri</span><span class="token punctuation">,</span> <span class="token variable">$callback</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$router</span><span class="token operator">-&gt;</span><span class="token function">patch</span><span class="token punctuation">(</span> <span class="token variable">$uri</span><span class="token punctuation">,</span> <span class="token variable">$callback</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$router</span><span class="token operator">-&gt;</span><span class="token function">delete</span><span class="token punctuation">(</span> <span class="token variable">$uri</span><span class="token punctuation">,</span> <span class="token variable">$callback</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$router</span><span class="token operator">-&gt;</span><span class="token function">any</span><span class="token punctuation">(</span> <span class="token variable">$uri</span><span class="token punctuation">,</span> <span class="token variable">$callback</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// responds to any HTTP verb</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="controllers"><a href="#controllers" class="header-anchor">#</a> Controllers</h2> <p>FluentCRM provides a base controller class that can be extended to create your own controllers.
The base controller class provides a number of useful methods for working with the request and response objects.
Let's look at an example of a controller class that extends the base controller class:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">MyPlugin<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">FluentCrm<span class="token punctuation">\</span>Framework<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">MyController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Your controller logic goes here</span>
        <span class="token comment">// must return something </span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="controller-methods"><a href="#controller-methods" class="header-anchor">#</a> Controller Methods</h4> <p>The base controller class provides the following methods with brief descriptions of what each method does:</p> <ul><li><code>send</code>: This method is used to send a response with data and a status code.</li> <li><code>sendSuccess</code>: This method is used to send a success response with data and a status code.</li> <li><code>sendError</code>: This method is used to send an error response with data and a status code</li> <li><code>request</code>: This method returns the request object.</li> <li><code>response</code>: This method returns the response object.</li></ul> <p>Let's look at the example of sendSuccess method:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">// send user data as json</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'name'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'John Doe'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'email'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'john.doe@mail.com'</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">sendSuccess</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/*
 * the following method takes the request object and returns a response object
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">request</span><span class="token operator">-&gt;</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// do something with the data</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">sendSuccess</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="policies"><a href="#policies" class="header-anchor">#</a> Policies</h2> <p>Policies are classes that are used to authorize requests to routes.
The <code>verifyRequest</code> method is used to check if the current user has permission to access a route or method.
It returns a boolean value indicating whether the user has permission or not. To authorize it must return true.
You can customize the behavior of this method by checking for specific permissions or conditions.
You may check for a specific capability, or check if the user is logged in, or check if the user is an administrator, or any other condition you like.
Let's look at an example of a policy class:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">MyPlugin<span class="token punctuation">\</span>Policies</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">FluentCrm<span class="token punctuation">\</span>App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Policies<span class="token punctuation">\</span>BasePolicy</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">FluentCrm<span class="token punctuation">\</span>Framework<span class="token punctuation">\</span>Request<span class="token punctuation">\</span>Request</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * MyPolicy is a custom policy class for the MyPlugin plugin.
 * It extends the base Policy class from the FluentCRM plugin and provides
 * additional functionality for handling authorization requests.
 */</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">MyPolicy</span> <span class="token keyword">extends</span> <span class="token class-name">BasePolicy</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * @param \FluentCrm\Framework\Request\Request $request The request object containing information about the current request.
     * @return bool
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">verifyRequest</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
        <span class="token comment">//return $this-&gt;currentUserCan('fcrm_manage_contacts');</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="directory-structure"><a href="#directory-structure" class="header-anchor">#</a> Directory Structure</h2> <p>Your directory structure may look something like this:
(Note that, the directory structure shown here is just an example. You can organize your files however you like.)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>my-plugin/
├── my-plugin.php
├── Policies/
│   └── MyPolicy.php
└── Controllers/
    └── MyController.php

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>The my-plugin directory is the root directory for your plugin. It contains the following files and directories:</p> <ul><li><code>my-plugin.php</code>: This is the entry point for your plugin. It contains the code that run your Application when the plugin is activated.</li> <li><code>Policies/</code>: This directory contains the <code>MyPolicy</code> class, which is a custom policy class for your plugin. It extends the base Policy class from the FluentCRM plugin and provides additional functionality for handling authorization requests.</li> <li><code>Controllers/</code>: This directory contains the <code>MyController</code> class, which is a custom controller class for your plugin. It extends the base Controller class from the FluentCRM plugin and provides additional functionality for handling requests.</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/fluentcrm/fluent-crm-developers-docs/edit/master/src/extending-rest-api/index.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/23/2022, 3:57:22 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.54af8faa.js" defer></script><script src="/assets/js/4.202d7228.js" defer></script><script src="/assets/js/41.b93e1d1c.js" defer></script><script src="/assets/js/6.25d6c35f.js" defer></script><script src="/assets/js/5.36d7588c.js" defer></script>
  </body>
</html>
